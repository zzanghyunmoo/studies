# 모니터링 기초

## 질문 

### 1. 모니터링을 명확하게 정의하기 어려운 이유는 무엇인가?

**답변:**

모니터링은 다양한 목적과 범위를 포괄하기 때문에 명확하게 정의하기 어렵습니다.

- **다양한 관점**: 개발자에게는 애플리케이션 성능 추적, 인프라 팀에게는 시스템 리소스 관리, 비즈니스 팀에게는 KPI 추적이 모두 "모니터링"입니다.
- **경계의 모호함**: 로깅, 추적(tracing), 프로파일링, 알림 등이 모두 모니터링의 일부로 간주될 수 있습니다.
- **진화하는 개념**: 과거 단순한 가동시간(uptime) 체크에서, 현대에는 관찰가능성(Observability)까지 포함하는 개념으로 진화했습니다.

SRE에서는 모니터링을 "시스템의 상태를 이해하고, 문제를 감지하며, 의사결정을 내리기 위한 데이터 수집 및 분석"으로 봅니다.

---

### 2. 메트릭의 지연 시간이 실시간의 문제를 해결하는 데 집중하는 시스템 관리자의 작업에 영향을 미치는가?

**답변:**

네, 상당히 영향을 미칩니다.

**문제점:**
- **문제 감지 지연**: 메트릭 수집 간격이 1분이라면, 실제 장애 발생 후 최대 1분 뒤에야 감지됩니다.
- **Root Cause 분석 어려움**: 지연이 크면 문제의 원인과 결과 사이의 연관성을 파악하기 어렵습니다.
- **False 긍정/부정**: 짧은 스파이크(spike)를 놓치거나, 이미 해결된 문제에 대한 알림을 받을 수 있습니다.

**SRE 권장 수집 간격:**
- **Critical 메트릭**: 10-30초 간격
- **일반 메트릭**: 1분 간격
- **용량 계획용**: 5-15분 간격

실시간성과 리소스 사용 사이의 균형이 중요합니다.

---

### 3. 용량 계획을 올바르게 수행하기 위한 모니터링의 요구 사항은 무엇인가?

**답변:**

**용량 계획 모니터링 요구사항:**

1. **장기 데이터 보관**
   - 최소 6개월~1년 이상의 히스토리 데이터
   - 트렌드와 계절성 파악

2. **적절한 메트릭 수집**
   - CPU, 메모리, 디스크, 네트워크 사용률
   - 요청 처리량(throughput)
   - 응답 시간(latency)
   - 비즈니스 메트릭 (사용자 수, 트랜잭션 수 등)

3. **충분한 데이터 정확도**
   - 높은 해상도가 아닌, 정확한 평균/최대값
   - 백분위수(percentile) 데이터

4. **예측 가능성**
   - 성장률 추적
   - 피크 시간대 패턴 분석
   - 리소스 사용률과 비즈니스 메트릭의 상관관계

용량 계획에서는 실시간성보다 **정확성과 장기 트렌드**가 더 중요합니다.

---

### 4. 로깅은 모니터링으로 간주되는가

**답변:**

SRE 관점에서는 "일부는 그렇다"입니다.

**로깅과 모니터링의 관계:**

- **전통적 구분**: 
  - 모니터링 = 집계된 메트릭 (카운터, 게이지)
  - 로깅 = 개별 이벤트 기록

- **현대적 관점 (Observability)**:
  - 로그도 시스템 상태를 이해하는 중요한 데이터 소스
  - 로그에서 메트릭을 추출하는 것이 일반적 (예: 에러 로그 카운트)

**SRE에서의 실용적 구분:**
- **구조화된 로그 집계** (예: 에러율, 요청 수) → 모니터링
- **개별 로그 검색 및 분석** → 디버깅/조사
- **로그 기반 알림** → 모니터링

**결론**: 로깅은 모니터링의 보완재이며, 사용 방식에 따라 모니터링의 일부가 될 수 있습니다.

---

### 5. 메트릭 수집을 위해 푸시 기반 접근 방식을 사용하는 단점은 무엇인가

**답변:**

**푸시(Push) 방식의 단점:**

1. **네트워크 부하 및 장애 전파**
   - 각 서비스가 모니터링 서버로 직접 푸시
   - 모니터링 서버 장애 시 서비스에 영향 가능 (타임아웃, 리소스 소모)

2. **중앙 집중식 구성의 어려움**
   - 각 애플리케이션에 수집 간격, 엔드포인트 설정 필요
   - 모니터링 시스템 변경 시 모든 서비스 재배포/재설정

3. **서비스 디스커버리 문제**
   - 모니터링 시스템이 전체 인스턴스를 파악하기 어려움
   - 동적으로 생성/삭제되는 인스턴스 추적 어려움

4. **보안 문제**
   - 애플리케이션이 모니터링 서버 위치를 알아야 함
   - 인증/권한 관리 복잡도 증가

**반면 풀(Pull) 방식의 장점:**
- 모니터링 시스템이 타겟을 제어
- 서비스는 메트릭 엔드포인트만 노출
- 네트워크 장애 시 애플리케이션 영향 없음

Prometheus가 풀 방식을 선택한 이유이기도 합니다.

---

### 6. 일반적인 웹 서비스에 집중하기 위해 세 가지 기본 메트릭을 선택해야 한다면 어느 것이 될 것인가?

**답변:**

**Golden Signals 중 핵심 3가지:**

1. **요청 처리율 (Traffic/Request Rate)**
   - 초당 요청 수 (RPS)
   - 시스템이 얼마나 바쁜지 파악
   - 트렌드와 이상 패턴 감지

2. **에러율 (Error Rate)**
   - 실패한 요청의 비율 (5xx 에러 등)
   - 사용자에게 영향을 주는 가장 직접적인 지표
   - SLO 정의의 핵심

3. **지연 시간 (Latency)**
   - 응답 시간 (보통 P50, P95, P99)
   - 사용자 경험의 직접적 지표
   - 성능 저하의 조기 경보

**참고**: Google SRE Book에서는 4가지 Golden Signals (위 3개 + Saturation/포화도)를 제시하지만, 3개로 줄인다면 위 항목들이 가장 중요합니다.

이 3가지로 **사용자 영향도**를 가장 잘 파악할 수 있습니다.

---

### 7. 호스트에서 실행 중인 프로세스를 나열하는 방법으로 호스트에서 지정된 프로세스가 실행되고 있는지 확인하는 검사는 화이트박스나 블랙박스 모니터링인가?

**답변:**

**화이트박스 모니터링입니다.**

**이유:**
- **내부 상태 접근**: 시스템 내부에 접근하여 프로세스 목록을 확인
- **구현 세부사항 의존**: 특정 프로세스 이름이나 PID를 알아야 함
- **시스템 지식 필요**: 어떤 프로세스가 실행되어야 하는지 사전 지식 필요

**블랙박스 vs 화이트박스 비교:**

- **블랙박스**: 외부에서 서비스 동작 확인
  - 예: HTTP 엔드포인트에 요청 보내고 응답 확인
  - 사용자 관점의 가용성 체크

- **화이트박스**: 내부 메트릭과 상태 확인
  - 예: 프로세스 체크, 메모리 사용률, 내부 큐 길이
  - 시스템 관점의 상세 진단

**SRE 모범 사례:**
- 프로세스가 실행 중이어도 서비스는 실패할 수 있음 (데드락, 응답 불가)
- 화이트박스 모니터링(프로세스 체크)과 블랙박스 모니터링(실제 요청 테스트)을 **함께 사용**
- 프로세스 체크는 문제 진단에 유용하지만, 사용자 영향도는 블랙박스로 확인해야 함

---

## 참고 자료

- [Google SRE Book - Monitoring Distributed Systems](https://sre.google/sre-book/monitoring-distributed-systems/)
- [Google SRE Book - Practical Alerting](https://sre.google/sre-book/practical-alerting/)
- [Prometheus Documentation - Why Prometheus?](https://prometheus.io/docs/introduction/overview/)
- [The Four Golden Signals - Google SRE](https://sre.google/sre-book/monitoring-distributed-systems/#xref_monitoring_golden-signals)
- [Observability vs Monitoring - Honeycomb.io](https://www.honeycomb.io/what-is-observability)
- [Push vs Pull - Prometheus FAQ](https://prometheus.io/docs/introduction/faq/#why-do-you-pull-rather-than-push)